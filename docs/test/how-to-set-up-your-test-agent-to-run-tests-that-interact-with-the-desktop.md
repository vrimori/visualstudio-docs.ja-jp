---
title: デスクトップと対話するテストを実行するように Visual Studio Test Agent を構成する
ms.date: 10/20/2016
ms.topic: conceptual
helpviewer_keywords:
- agents, configuring for interaction with desktop
ms.assetid: 3a94dd07-6d17-402c-ae8f-7947143755c9
author: gewarren
ms.author: gewarren
manager: douge
ms.prod: visual-studio-dev15
ms.technology: vs-ide-test
ms.openlocfilehash: ee961a3f6fa62d46feebdedd10fb62ea8a9ee2a4
ms.sourcegitcommit: 495bba1d8029646653f99ad20df2f80faad8d58b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/31/2018
ms.locfileid: "39381730"
---
# <a name="how-to-set-up-your-test-agent-to-run-tests-that-interact-with-the-desktop"></a>方法: テスト エージェントを設定して、デスクトップと対話するテストを実行する

デスクトップと対話する自動テストを実行する場合、エージェントをサービスではなくプロセスとして実行されるように設定する必要があります。 たとえば、テスト コントローラーとテスト エージェントを使用してコード化された UI テストをリモートで実行する場合、またはテストを実行してテストの実行時にビデオ記録をキャプチャする場合は、エージェントをプロセスとして実行されるように設定する必要があります。 Visual Studio を使用してテストの設定でエージェントをロールに割り当てる場合や、Microsoft Test Manager を使用して環境内でエージェントをロールに割り当てる場合は、デスクトップと対話する必要があるロールに割り当てられたすべてのエージェントの設定を変更する必要があります。

> [!WARNING]
> Microsoft Test Manager を使用してラボ環境を設定する場合、テスト エージェントがインストールされます。 コード化された UI テストを実行できるようにロールの 1 つを構成する場合は、**環境の作成ウィザード**で指定できます。

> [!IMPORTANT]
> コード化された UI テストを実行するエージェントを実行するコンピューターは、ロックしたり、スクリーン セーバーを有効にしたりできません。

ブラウザーを起動するコード化された UI テストを実行する場合、テスト エージェントのサービス アカウントがそのブラウザーの起動に使用されます。 このサービス アカウントは、このコンピューターでアクティブなユーザーであるユーザー アカウントと同じである必要があります。 同じユーザー アカウントでない場合、ブラウザーは起動しません。

> [!IMPORTANT]
> ビルド定義の一部としてブラウザーを起動するコード化された UI テストを実行する場合、ビルド サービスのサービス アカウントがそのブラウザーの起動に使用されます。 このサービス アカウントは、このコンピューターでアクティブなユーザーであるユーザー アカウントと同じである必要があります。 同じユーザー アカウントでない場合、ブラウザーは起動しません。

 デスクトップと対話する必要があるタスクを実行するロールに割り当てられたエージェントを設定するには、次の手順を実行します。

## <a name="to-set-up-an-agent-to-run-as-a-process"></a>エージェントをプロセスとして実行されるように設定するには

1.  インストールしたテスト エージェントをプロセスとして実行するよう構成するには、**[スタート]**、**[すべてのプログラム]**、**[Microsoft Visual Studio]**、**[Microsoft Visual Studio Test Agent 構成ツール]** の順に進みます。

     **[Test Agent の構成]** ダイアログ ボックスが表示されます。

2.  プロセスとして実行することを選択するためのページを表示するには、**[実行オプション]** をクリックします。

     エージェントをプロセスまたはサービスのどちらとして実行するかを選択できるページが表示されます。

3.  **[対話型プロセス]** を選択します。 テスト エージェントは、サービスではなくプロセスとして起動されます。 **[次へ]** をクリックします。

     ここで、テスト エージェントをプロセスとして起動するときに使用するユーザーについての詳細を入力したり、その他のオプションを選択したりできます。

    > [!NOTE]
    > プロセスを起動するために追加したユーザーは、このエージェントのテスト コントローラーであるコンピューターの TeamTestAgentService グループのメンバーとしても追加する必要があります。 このユーザーが現在のユーザーである場合は、このユーザーをテスト コントローラー コンピューターに追加するとき、このコンピューターをログオフするか、再起動する必要があります。

4.  **[ユーザー名]** に名前を入力します。

5.  **[パスワード]** にパスワードを入力します。

     **ユーザー アカウントに関する重要な情報:**

    -   ユーザー アカウントに null パスワードは使用できません。

    -   IntelliTrace またはネットワーク エミュレーション データ診断アダプターを使用するには、ユーザー アカウントが Administrators グループのメンバーである必要があります。 テスト エージェントを実行するコンピューターで最小特権のユーザー アカウントを持つ OS が実行されている場合は、(昇格した) 管理者としてテスト エージェントを実行する必要があります。 エージェント ユーザー名がエージェント サービスにない場合は、そのユーザー名を追加しようとするので、テスト コントローラーに対するアクセス許可が必要です。

    -   テスト コントローラーを使用するユーザーは、テスト コントローラーの Users アカウントに属している必要があります。このアカウントに属していない場合は、コントローラーに対してテストを実行できません。

6.  テスト エージェントが構成されたコンピューターで、コンピューターの再起動後にテストを実行できることを確認するには、テスト エージェント ユーザーとして自動的にログオンするようにコンピューターを設定します。 **[自動的にログオンする]** をオンにします。 これで、ユーザー名とパスワードが暗号化された形式でレジストリに保存されます。

    > [!NOTE]
    > リモート デスクトップまたはゲスト ベース接続を使用してラボ環境に接続しているときに、予期しない切断が頻繁に発生することがあります。 接続が失われる原因の 1 つとして、コンピューターがネットワークに自動的にログオンするように構成されていることが考えられます。

7.  スクリーン セーバーはデスクトップと対話する必要がある自動テストに干渉する可能性があるため、スクリーン セーバーを確実に無効にするには、**[スクリーン セーバーを無効にする]** をオンにします。

    > [!WARNING]
    > 自動的にログオンする、またはスクリーン セーバーを無効にすると、セキュリティ上のリスクが生じます。 自動ログオンを有効にすると、他のユーザーがこのコンピューターを起動して、自動ログオンするアカウントを使用できるようになります。 スクリーン セーバーを無効にすると、コンピューターのロックを解除するためにユーザーのログオンを要求するプロンプトが表示されなくなる可能性があります。 この結果、コンピューターに物理的にアクセスできれば、だれでもコンピューターを使用できるようになります。 これらの機能をコンピューターで有効にする場合は、これらのコンピューターが物理的に安全であることを確認してください。 たとえば、これらのコンピューターを物理的に安全なラボに設置するなどの措置を講じます。 **[スクリーン セーバーを無効にする]** をオフにしても、この操作だけではスクリーン セーバーは有効になりません。

     エージェントがサービスとして実行されるように戻すには、このツールを使用して **[サービス]** を選択します。

8.  変更を適用するには、**[設定の適用]** をクリックします。

     テスト エージェントを構成する各ステップの状態を示す **[構成の概要]** ダイアログ ボックスが表示されます。

9. **[構成の概要]** ダイアログ ボックスを閉じるには、**[閉じる]** を選択します。 **[閉じる]** をもう一度選択して、**Test Agent 構成ツール**を終了します。

    > [!NOTE]
    > コンピューターには、プロセスとして実行されているテスト エージェントに関する通知領域アイコンが表示されます。 このアイコンは、テスト エージェントの状態を示します。 このツールを使用してエージェントがプロセスとして実行されている場合は、エージェントを起動、停止、または再起動できます。 テスト エージェントが実行されていない場合にプロセスとして開始するには、**[スタート]**、**[すべてのプログラム]**、**[Microsoft Visual Studio]**、**[Microsoft Visual Studio Test Agent]** の順に選択します。

     このテスト エージェントのテスト コントローラーが Team Foundation Server に登録されている場合、対話型プロセスとして実行されているテスト エージェントの状態が Microsoft Test Manager の **[ラボ センター]** の **[コントローラー]** ビューに表示されます。 対話型プロセスとして実行されていることを示すために、前にアスタリスク (*) 記号が付いています。 このテスト エージェントを再開するには、**[コントローラー]** ビューではなく、テスト エージェントのコンピューターで実行されているツールを使用する必要があります。

## <a name="see-also"></a>関連項目

- [テスト エージェントをインストールして構成する](../test/lab-management/install-configure-test-agents.md)