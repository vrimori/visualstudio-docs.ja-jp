---
title: Visual Studio を使用してアプリをデバッグする
description: Visual Studio デバッガーを使用してアプリケーションのデバッグを開始する
ms.custom: mvc
ms.date: 01/09/2019
ms.topic: quickstart
helpviewer_keywords:
- debugger
ms.assetid: c763d706-3213-494f-b4d2-990b6e1ec456
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 638e49a2e2146503186eb26f25e67ff68bb4a354
ms.sourcegitcommit: 2193323efc608118e0ce6f6b2ff532f158245d56
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/25/2019
ms.locfileid: "55042063"
---
# <a name="first-look-at-the-visual-studio-debugger"></a>最初に Visual Studio デバッガーを見る

このトピックでは、Visual Studio によって提供されるデバッガー ツールが紹介されます。 Visual Studio で*自分のアプリをデバッグする*とき、通常、それはデバッガーをアタッチした状態で (つまり、デバッガー モードで) アプリケーションを実行することを意味します。 これを行うとき、デバッガーには、コードが実行されている間にそのコードによって何が行われているのかを確認するためのさまざまな方法が用意されています。 コードをステップ実行して変数内に格納されている値を確認したり、変数に対してウォッチ式を設定して値が変わるタイミングを確認したり、コードの実行パスを調べたりできます。コードのデバッグを試みるのが今回初めての場合、このトピックを読み進める前に[超初心者向けのデバッグ方法](../debugger/debugging-absolute-beginners.md)に関するページを参照することをお勧めします。

ここで説明する機能は C#、C++、Visual Basic、JavaScript、さらに Visual Studio でサポートされているその他の言語に適用されます (特別な記載のない限り)。

## <a name="set-a-breakpoint-and-start-the-debugger"></a>ブレークポイントを設定し、デバッガーを開始する

デバッグするには、アプリ プロセスにデバッガーをアタッチした状態でアプリを開始する必要があります。 **F5** (**[デバッグ]、[デバッグの開始] の順に選択**) がそれを行う最も一般的な方法です。 しかしながら、現時点ではアプリ コードを調べるためのブレークポイントを設定していないかもしれません。そこで、最初にブレークポイントを設定し、それからデバッグを開始します。 ブレークポイントは、信頼できるデバッグの最も基本的で重要な機能です。 ブレークポイントは、Visual Studio が実行コードを中断する場所を示します。これにより、変数の値またはメモリの動作を確認したり、コードの分岐が実行されるかどうかを確認したりすることができます。 

コード エディターでファイルを開いている場合、コード行の左にある余白をクリックすることでブレークポイントを設定できます。

![ブレークポイントを設定する](../debugger/media/dbg-tour-set-a-breakpoint.gif "ブレークポイントを設定する")

**F5** キーを押す (**[デバッグ]、[デバッグの開始] の順に選択する**) か、デバッグ ツールバーの **[デバッグの開始]** ボタン![デバッグの開始](../debugger/media/dbg-tour-start-debugging.png "デバッグの開始")を選択します。デバッガーが最初のブレークポイントで実行されます。 アプリがまだ実行されていない場合、F5 キーを押すとデバッガーが起動し、最初のブレークポイントで停止します。

ブレークポイントは、詳細に調べたいコード行またはコード セクションがわかっている場合に便利な機能です。

## <a name="navigate"></a> ステップ コマンドを使用してデバッガーでコード内を移動する

ほとんどのコマンドにはキーボード ショートカットが用意されています。キーボード ショートカットはアプリ コード内の移動を簡単にします。 (メニュー コマンドなど、同等のコマンドを括弧内に示します。)

デバッガーをアタッチした状態でアプリを開始し、**F11** を押します (**[デバッグ]、[ステップ イン] の順に選択**)。 F11 キーは **[ステップ イン]** コマンドであり、アプリの実行が一度に 1 ステートメント進められます。 F11 でアプリを開始すると、デバッガーは実行される最初のステートメントで停止します。

![F11 ステップ イン](../debugger/media/dbg-tour-f11.png "F11 ステップ イン")

黄色の矢印はデバッガーが一時停止しているステートメントを表します。デバッガーの一時停止によってアプリの実行も同じポイントで中断されます (このステートメントはまだ実行されていません)。

F11 キーは実行フローを最も詳しく確認することができる便利な方法です。 (コード内をより速く移動するために、他の選択肢についてもいくつか紹介します。)既定では、非ユーザー コードはデバッガーによってスキップされます (詳細については、[マイ コードのみ](../debugger/just-my-code.md)に関するページを参照)。

>[!NOTE]
> マネージド コードにダイアログ ボックスが表示され、プロパティと演算子を自動的にスキップする (既定の動作) ときに通知が必要か問われます。 設定を後で変更する場合、**[デバッグ]** の下にあるメニューから **[ツール]、[オプション]** の順に選択し、**[プロパティおよび演算子のステップ オーバー]** を無効にします。

## <a name="step-over-code-to-skip-functions"></a>コードをステップ オーバーして関数をスキップする

関数またはメソッド呼び出しのコード行にあるとき、F11 の代わりに **F10** を押すことができます (**[デバッグ]、[ステップ オーバー] の順に選択**)。

F10 キーを押すと、アプリ コード内の関数またはメソッドにステップ インすることなく、デバッガーが進められます (コードはまだ実行されています)。 F10 キーを押すことで、関心のないコードをスキップできます。 この方法により、関心の高いコードまですばやく到達できます。

## <a name="step-into-a-property"></a>プロパティにステップ インする

前述のとおり、既定ではデバッガーは管理対象のプロパティとフィールドをスキップしますが、**[関数にステップ イン]** コマンドを実行すると、この動作をオーバーライドできます。

プロパティまたはフィールドを右クリックし、**[関数にステップ イン]** を選択します。次に、利用できるオプションから 1 つ選択します。

![関数にステップ イン](../debugger/media/dbg-tour-step-into-specific.png "関数にステップ イン")

この例では、**[関数にステップ イン]** を選択し、`Path.set` のコードに移動します。

![関数にステップ イン](../debugger/media/dbg-tour-step-into-specific-2.png "関数にステップ イン")

## <a name="run-to-a-point-in-your-code-quickly-using-the-mouse"></a>マウスを使用し、コード内のポイントにすばやく移動する

デバッガーの使用中、コード行にマウス カーソルを合わせると、**[クリックで実行]** ボタン ![クリックで実行](../debugger/media/dbg-tour-run-to-click.png "クリックで実行") が左に表示されます。

![クリックで実行](../debugger/media/dbg-tour-run-to-click-2.png "クリックで実行")

> [!NOTE]
> **[クリックで実行]** (ここまで実行します) ボタンは [!include[vs_dev15](../misc/includes/vs_dev15_md.md)] の新機能です。

**[クリックで実行]** (ここまで実行します) ボタンをクリックします。 クリックしたコード行までデバッガーが進みます。

このボタンを使用することは、一時的なブレークポイントを設定することに似ています。 このコマンドは、アプリ コードの目に見える領域内ですばやく移動する場合にも便利です。 **[クリックして実行]** は開いているあらゆるファイルで使用できます。

## <a name="advance-the-debugger-out-of-the-current-function"></a>現在の関数の終わりまでデバッガーを進める

デバッグ セッションを続けるとき、現在の関数の終わりまで進めると便利な場合があります。

**Shift + F11** キーを押します (または **[デバッグ]、[ステップ アウト]** の順に選択します)。

このコマンドを使用すると、アプリの実行が再開され (そしてデバッガーが前へ進められ)、現在の関数から制御が戻るまで続けられます。

## <a name="run-to-cursor"></a>[カーソル行の前まで実行]

赤色の **[デバッグの停止]** ボタン ![デバッグの停止](../debugger/media/dbg-tour-stop-debugging.png "デバッグの停止") を押すか、**Shift** + **F5** キーを押してデバッガーを停止します。

アプリ内のコード行を右クリックし、**[カーソル行の前まで実行]** を選択します。 このコマンドによってデバッグが開始され、現在のコード行に一時的なブレークポイントが設定されます。

![カーソル行の前まで実行](../debugger/media/dbg-tour-run-to-cursor.png "カーソル行の前まで実行")

ブレークポイントを設定した場合、最初のブレークポイントでデバッガーが一時停止します。

**[カーソル行の前まで実行]** を選択したコード行に到達するまで **F5** を押します。

このコマンドは、コードの編集時、一時的なブレークポイントをすばやく設定し、同時にデバッガーを開始するときに便利です。

> [!NOTE]
> デバッグ中、**[呼び出し履歴]** ウィンドウで **[カーソル行の前まで実行]** を使用できます。

## <a name="restart-your-app-quickly"></a>アプリを簡単に再起動する

デバッグ ツールバーにある **[再起動]** ![アプリの再起動](../debugger/media/dbg-tour-restart.png "アプリの再起動") ボタンをクリックします (**Ctrl + Shift +F5**)。

**[再起動]** を押すと、アプリを停止してからデバッガーを再起動する場合と比較して時間の節約になります。 デバッガーは、コードを実行すると最初にヒットするブレークポイントで一時停止します。

デバッガーを停止、コード エディターに戻る場合、**[再起動]** ではなく、赤色の ![[デバッグの停止]](../debugger/media/dbg-tour-stop-debugging.png "デバッグの停止") 停止ボタンを押すことができます。

## <a name="inspect-variables-with-data-tips"></a>データ ヒントを使用して変数を確認する

対処方法を少し理解できたところで、デバッガーでアプリの状態 (変数) を調べてみることをお勧めします。 変数を調べる機能は、デバッガーの機能の中で最も便利な機能の 1 つに挙げられます。変数をさまざまな方法で調べることができます。 多くの場合、問題をデバッグしてみるとき、特定のアプリの状態で変数に求められる値がそのとおりに変数に格納されているかどうかを確認してみます。

デバッガーで一時停止しているとき、マウス カーソルをオブジェクトに合わせるとそのプロパティ値が表示されます (この例では、ファイル名 `market 031.jpg` が既定のプロパティ値です)。

![データ ヒントを表示する](../debugger/media/dbg-tour-data-tips.gif "データ ヒントを表示する")

オブジェクトを展開すると、そのすべてのプロパティが表示されます (この例の `FullPath` プロパティなど)。

多くの場合、デバッグを行うとき、オブジェクト上でプロパティ値を簡単に確認できると便利です。データ ヒントはお勧めの手法です。

> [!TIP]
> サポートされているほとんどの言語で、デバッグ セッション中にコードを編集できます。 詳細については、「[エディット コンティニュ](../debugger/edit-and-continue.md)」を参照してください。

## <a name="inspect-variables-with-the-autos-and-locals-windows"></a>[自動変数] ウィンドウと [ローカル] ウィンドウを使用して変数を確認する

デバッグ中、コード エディターの下部にある **[自動変数]** ウィンドウを見てください。

![[自動変数] ウィンドウ](../debugger/media/dbg-tour-autos-window.png "[自動変数] ウィンドウ")

**[自動変数]** ウィンドウには、変数、その現在の値、その型が表示されます。 **[自動変数]** ウィンドウには、現在の行または前の行で使用されている変数がすべて表示されます (C++ では、このウィンドウには先行する 3 行のコードに含まれている変数が表示されます。 言語固有の動作についてはマニュアルを参照してください)。

> [!NOTE]
> JavaScript では、**[ローカル]** ウィンドウはサポートされていますが、**[自動変数]** ウィンドウはサポートされていません。

次に、**[ローカル]** ウィンドウを見てください。 **[ローカル]** ウィンドウを確認すれば、スコープに現在含まれている変数がわかります。

![[ローカル] ウィンドウ](../debugger/media/dbg-tour-locals-window.png "[ローカル] ウィンドウ")

この例では、`this` オブジェクトとオブジェクト `f` がスコープに含まれています。 詳細については、「[[自動変数] と [ローカル] ウィンドウで変数を検査](../debugger/autos-and-locals-windows.md)」を参照してください。

## <a name="set-a-watch"></a>ウォッチ式を設定する

**[ウォッチ]** ウィンドウを使用することで、監視する変数 (または式) を指定できます。

デバッグ中、オブジェクトを右クリックし、**[ウォッチ式の追加]** を選択します。

![[ウォッチ] ウィンドウ](../debugger/media/dbg-tour-watch-window.png "[ウォッチ] ウィンドウ")

この例では、`f` オブジェクトにウォッチ式が設定されています。デバッガー内を移動しながらその値の変化を確認できます。 その他の変数ウィンドウとは異なり、**[ウォッチ]** ウィンドウには監視対象の変数が常に表示されます (対象外のときは淡色表示となります)。

詳細については、「[Set a Watch using the Watch and QuickWatch Windows](../debugger/watch-and-quickwatch-windows.md)」 (ウォッチ ウィンドウとクイックウォッチ ウィンドウを使用してウォッチを設定する) を参照してください。

## <a name="examine-the-call-stack"></a>呼び出し履歴を調べる

デバッグ中、**[呼び出し履歴]** ウィンドウをクリックします。このウィンドウは既定では右下ペイン内に表示されます。

![呼び出し履歴を調べる](../debugger/media/dbg-tour-call-stack.png "呼び出し履歴を調べる")

**[呼び出し履歴]** ウィンドウには、メソッドおよび関数が呼び出されている順番が表示されます。 先頭行には、現在の関数が表示されます (この例の `Update` メソッド)。 2 行目には、`Update` が `Path.set` プロパティから呼び出されたことが表示されます。3 行目以降にも同様の内容が表示されます。 呼び出し履歴は、アプリの実行フローを調査して理解するのに優れた方法です。

> [!NOTE]
> **[呼び出し履歴]** ウィンドウは、Eclipse のような一部の IDE におけるデバッグ パースペクティブに似ています。

コード行をダブルクリックすることで、ソース コードに移動できます。また、それによって、デバッガーで検査されている現在のスコープを変更することもできます。 この操作でデバッガーが前に進むことはありません。

**[呼び出し履歴]** ウィンドウから右クリック メニューを使用して他の操作を行うこともできます。 たとえば、特定の関数にブレークポイントを挿入したり、**[カーソル行の前まで実行]** を使用してアプリを再起動したり、ソース コードの調査を開始したりできます。 「[方法:呼び出し履歴を調べる](../debugger/how-to-use-the-call-stack-window.md)」を参照してください。

## <a name="exception"></a> 例外を調べる

アプリが例外をスローした場合、デバッガーによってその例外をスローしたコード行が示されます。

![例外ヘルパー](../debugger/media/dbg-tour-exception-helper.png "例外ヘルパー")

この例では、**例外ヘルパー**に `System.Argument` 例外とエラー メッセージが表示され、パスの書式が正しくないことが示されています。 そのため、このエラーがメソッドまたは関数の引数で発生したことがわかります。

この例では、`DirectoryInfo` 呼び出しによって、`value` 変数に格納されている空の文字列にエラーが発生しました。

例外ヘルパーは、エラーのデバッグに役立つ優れた機能です。 エラーの詳細を表示したり、例外ヘルパーからウォッチ式を追加したりすることもできます。 あるいは、必要であれば、特定の例外をスローするための条件を変更できます。 コード内で例外を処理する方法の詳細については、[デバッグのテクニックとツール](../debugger/write-better-code-with-visual-studio.md)に関するページを参照してください。

> [!NOTE]
> 例外ヘルパーは [!include[vs_dev15](../misc/includes/vs_dev15_md.md)] の例外アシスタントに取って代わるものです。

**[例外設定]** ノードを展開すると、この種類の例外を処理する方法がいくつか表示されますが、今回のツアーでは何も変える必要はありません。

## <a name="debug-live-aspnet-apps-in-azure-app-service"></a>Azure App Service でライブ ASP.NET アプリをデバッグする

**スナップショット デバッガー**では、関心のあるコードの実行時に実稼働アプリのスナップショットが作成されます。 スナップショットを取得するようにデバッガーに指示するには、コードでスナップショットとログポイントを設定します。 デバッガーでは、実稼働アプリケーションのトラフィックに影響を与えることなく、問題を正確に確認できます。 スナップショット デバッガーは、実稼働環境で発生する問題の解決にかかる時間を大幅に短縮するのに役立ちます。

![スナップショット デバッガーを起動する](../debugger/media/snapshot-launch.png "スナップショット デバッガーを起動する")

スナップショット コレクションは、Azure App Service で実行されている ASP.NET アプリケーションで利用できます。 ASP.NET アプリケーションは .NET Framework 4.6.1 以降で実行する必要があります。ASP.NET Core アプリケーションは Windows 上の .NET Core 2.0 以降で実行する必要があります。

詳細については、「[Debug live ASP.NET apps using the Snapshot Debugger](../debugger/debug-live-azure-applications.md)」(スナップショット デバッガーを使用してライブ ASP.NET アプリをデバッグする) を参照してください。

## <a name="view-snapshots-with-intellitrace-step-back-visual-studio-enterprise"></a>IntelliTrace ステップバックでスナップショットを表示する (Visual Studio Enterprise)

**IntelliTrace のステップ バック**では、ブレークポイントとデバッガー ステップ イベントごとにアプリケーションのスナップショットを自動作成します。 記録されたスナップショットにより、前のブレークポイントまたはステップに戻り、過去の時点でのアプリケーションの状態を確認できるようになります。 IntelliTrace ステップ バックでは、以前のアプリケーションの状態を確認したいが、デバッグの再開や必要なアプリ状態の再作成は必要でない場合に時間を節約できます。

スナップショット間を移動して表示するには、デバッグ ツールバーの **[前に戻る]** ボタンと **[次へ進む]** ボタンを使用します。 これらのボタンを使用して、**[診断ツール]** ウィンドウの **[イベント]** タブに表示されるイベント間を移動します。

![[前に戻る] ボタンと [次へ進む] ボタン](../debugger/media/intellitrace-step-back-icons-description.png  "[前に戻る] ボタンと [次へ進む] ボタン")

詳細について、[IntelliTrace を使用して以前のアプリの状態を検査する](../debugger/view-historical-application-state.md)方法に関するページを参照してください。

## <a name="next-steps"></a>次の手順

このチュートリアルでは、デバッガーのさまざまな機能を簡単に見てきました。 ブレークポイントなど、いずれかの機能についてさらに詳しく学習できます。

> [!div class="nextstepaction"]
> [ブレークポイントの使用について学習する](../debugger/using-breakpoints.md)
